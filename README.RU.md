[![EN](https://user-images.githubusercontent.com/9499881/33184537-7be87e86-d096-11e7-89bb-f3286f752bc6.png)](https://github.com/r57zone/Zapper-Light-Gun-PC/) 
[![RU](https://user-images.githubusercontent.com/9499881/27683795-5b0fbac6-5cd8-11e7-929c-057833e01fb1.png)](https://github.com/r57zone/Zapper-Light-Gun-PC/blob/master/README.RU.md)

Модификация светового пистолета от Денди (Famicom и других) для ПК эмуляторов NES (FCEUX).

[![](https://user-images.githubusercontent.com/9499881/212734602-05fe86a4-f981-49e0-bcda-7e930fe3c7f1.gif)](https://youtu.be/HwHkjYlQwL0)

## Что понадобится:
1. Световой пистолет для Денди. Можно приобрести на AliExpress или Ozon.
2. Резистор на 4.7 кОм.
3. Плата [Digispark](http://alii.pub/5r59m3) (подойдет как большая, так и маленькая).

## Пайка
У светового пистолета 4 пина (контакта): питание 5 вольт (+), земля (-), цифровой пин кнопки, цифровой пин зависимый от значения фоторезистора.


Чтобы определить пины нужно разобрать пистолет, далее нужно найти землю (-), на землю идёт один из контактов кнопки (курка), второй контакт кнопки это цифровой пин значения кнопки. Как правило питание (+) имеет красный цвет, также оно скорее всего находится с противоположной стороны от земли (-). Оставшийся пин отвечает за фоторезистор.


![](https://user-images.githubusercontent.com/9499881/117061591-7141b100-ad33-11eb-80b0-2412987df08b.png)

* Фоторезистор припаивается к пину 2.<br>
* Кнопка припаивается к пину 0.<br>
* Плюс припаивается на 5v, а минус на GND.<br>
* Также нужно припаять резистор на 4.7 кОм с пина 2 на 5v.

## Прошивка Digispark
1. Загрузите [Arduino IDE](https://www.arduino.cc/en/software) и распакуйте.
2. Установите последние [драйверы Digispark](https://github.com/digistump/DigistumpArduino/releases/) ("Digistump.Drivers.zip").
3. Запустите Arduino IDE, перейдите в настройки и добавьте `https://raw.githubusercontent.com/digistump/arduino-boards-index/master/package_digistump_index.json` в поле "Дополнителньые ссылки для менеджера плат" и нажмите "ОК".
4. Перейдите в "Инструменты" -> "Плата" -> "Менеджер плат", введите в поиске `Digistump AVR boards` и установите.
5. Скопируйте [содержимое прошивки](https://github.com/r57zone/Zapper-Light-Gun-PC/blob/master/Firmware/DigisparkLightGun.ino), вставьте в Arduino IDE и нажмите кнопку "Вгрузить".
6. Подключите плату Digispark после нажатия кнопки прошивки. Digispark прошивается сразу после подключения (нужно перевтыкать для перепрошивки).

## Настройка FCEUX
1. Загрузите [FCEUX](https://fceux.com/web/download.html) и распакуйте ("FCEUX 2.3.0 win32 Binary").
2. Запустите и перейдите в "Config" -> "Input".
3. Настройте первый геймпад или отключите его (для светого пистолета в нём нет необходимости), а во втором геймпаде выберите **"LCD Zapper (Advance)"**.
4. В этом же окне, в раделе второго геймпада нажмите "Configure".
5. Окне "LCD Zapper (Advance)" нажмите на кнопку Trigger и 2 раза нажмите на кнопку светового пистолета. Далее нажмите на кнопку "Light Sensor" и 2 раза посветите чем-нибудь в дуло пистолета или можно в программе "Paint" быстро перекрасить черный фон на белый, кликая правой и левой кнопкой мыши, и наведя пистолет в область отрисовки.
6. При старте игры выстрелите в меню, чтобы задержка светового пистолета определилась патченным ромом (игрой).

## Исправление проблем
Если вы используете монитор с минимальной яркостью и пистолет не работает, то попробуйте немного увеличить яркость на время игры.

## Игры (Ромы)
Благодаря проекту [NESLCDMod](http://neslcdmod.ru) появилась возможность играть в оригинальные NES игры на современных мониторах и телевизорах.


На сайте [можно загрузить патчи для игр](http://neslcdmod.ru/roms/) и применить их к оригинальным ромам, с помощью программы [Lunar IPS](http://fusoya.eludevisibility.org/lips/download/lips102.zip).


### Применение патча
1. Найдите оригинальный файл игры "Duck Hunt (World).nes" (MD5: `D802E9D7B8BFD586F878E0922F62BF46`).
2. Загрузите [последний патч](http://neslcdmod.ru/roms/) для неё.
3. Запустите [Lunar IPS](http://fusoya.eludevisibility.org/lips/download/lips102.zip) и откройте патч.
4. Далее выберите оригинальный ром и пропатченная игра готова.

## Благодарности
* Проекту [NESLCDMod](http://neslcdmod.ru), который позволил нам играть в NES игры на современных мониторах и телевизорах.
* Разработчикам эмулятора [FCEUX](https://github.com/TASVideos/fceux/graphs/contributors) за хороший эмулятор NES игр.
* Разработчику [Jason W. Thompson](https://github.com/JasonWThompson) за добавление поддержки световых пистолетов в эмулятор FCEUX.
* Разработчику и радиолюбителю [Алексею Кластеру](https://github.com/ClusterM) за схему подключения световых пистолетов.

## Обратная связь
`r57zone[собака]gmail.com`